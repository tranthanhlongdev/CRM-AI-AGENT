=========================================
VOICEBOT SOFTPHONE - HÆ¯á»šNG DáºªN TEST
=========================================

ğŸ¯ Tá»”NG QUAN
============

Backend Python Ä‘Ã£ tÃ­ch há»£p sáºµn 2 trang web Ä‘á»ƒ test há»‡ thá»‘ng call center:

1. **Softphone** (Customer) - http://localhost:8000/softphone
2. **Agent Dashboard** (Agent) - http://localhost:8000/agent-dashboard

ğŸš€ CÃCH TEST CALL FLOW
======================

### BÆ°á»›c 1: Khá»Ÿi Ä‘á»™ng Server
```bash
cd /path/to/VoiceBot
source venv/bin/activate
python app.py
```

### BÆ°á»›c 2: Má»Ÿ 3 Tab Browser

**Tab 1 - CRM System:**
- VÃ o: http://localhost:8000/crm-demo
- CRM sáº½ tá»± Ä‘á»™ng káº¿t ná»‘i vÃ  nháº­n WebSocket events

**Tab 2 - Agent Dashboard:**
- VÃ o: http://localhost:8000/agent-dashboard
- Chá»n agent (Admin User hoáº·c Test User CRM)
- Click "Login"
- Click "ğŸŸ¢ Available" Ä‘á»ƒ sáºµn sÃ ng nháº­n cuá»™c gá»i

**Tab 3 - Softphone:**
- VÃ o: http://localhost:8000/softphone
- Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i (máº·c Ä‘á»‹nh: 0912345678)
- Click "ğŸ“ Gá»i"

### BÆ°á»›c 3: Test Call Flow

1. **Softphone gá»i** â†’ Cuá»™c gá»i Ä‘Æ°á»£c táº¡o vÃ  tÃ¬m agent available
2. **CRM nháº­n event** â†’ Popup hiá»ƒn thá»‹ incoming call vá»›i thÃ´ng tin customer
3. **CRM cÃ³ thá»ƒ answer/reject** â†’ Hoáº·c Ä‘á»ƒ agent tá»± answer
4. **Agent nháº­n cuá»™c gá»i** â†’ Xuáº¥t hiá»‡n trong "Incoming Calls", click "ğŸ“ Answer"
5. **Káº¿t ná»‘i thÃ nh cÃ´ng** â†’ Cáº£ 2 bÃªn cÃ³ thá»ƒ nÃ³i chuyá»‡n qua WebRTC
6. **CRM track real-time** â†’ Theo dÃµi tráº¡ng thÃ¡i cuá»™c gá»i vÃ  agent
7. **Káº¿t thÃºc cuá»™c gá»i** â†’ Click "ğŸ“´ End Call" á»Ÿ báº¥t ká»³ bÃªn nÃ o

ğŸ™ï¸ TÃNH NÄ‚NG VOICE CALL
========================

### WebRTC Features:
- âœ… **Real-time audio** giá»¯a Customer vÃ  Agent
- âœ… **Mute/Unmute** controls
- âœ… **Auto microphone access** (cáº§n cho phÃ©p browser)
- âœ… **Echo cancellation** vÃ  noise suppression
- âœ… **Connection monitoring**

### Browser Requirements:
- **Chrome/Edge**: Recommended âœ…
- **Firefox**: Supported âœ…
- **Safari**: Limited support âš ï¸
- **HTTPS**: Required for production ğŸ”’

ğŸ”§ CÃC TÃNH NÄ‚NG TEST
=====================

### Softphone Features:
- ğŸ“ **Make Call** - Gá»i tá»›i tá»•ng Ä‘Ã i
- ğŸ“´ **End Call** - Káº¿t thÃºc cuá»™c gá»i
- ğŸ”‡ **Mute/Unmute** - Táº¯t/báº­t micro
- ğŸ‘¥ **View Agents** - Xem danh sÃ¡ch agents available
- ğŸ”„ **Auto Test** - Test tá»± Ä‘á»™ng call flow
- ğŸ“Š **Real-time logs** - Theo dÃµi events

### Agent Dashboard Features:
- ğŸ” **Agent Login** - ÄÄƒng nháº­p agent
- ğŸ“Š **Status Management** - Thay Ä‘á»•i tráº¡ng thÃ¡i (Available/Busy/Away)
- ğŸ“ **Answer Calls** - Nháº­n cuá»™c gá»i Ä‘áº¿n
- âŒ **Reject Calls** - Tá»« chá»‘i cuá»™c gá»i
- ğŸ™ï¸ **Call Controls** - Mute, Hold, End call
- ğŸ“ˆ **Statistics** - Thá»‘ng kÃª cuá»™c gá»i
- ğŸ“‹ **Activity Log** - Lá»‹ch sá»­ hoáº¡t Ä‘á»™ng

ğŸ§ª TEST SCENARIOS
=================

### Scenario 1: Basic Call Flow
1. Agent login vÃ  set status = "available"
2. Customer gá»i tá»« softphone
3. Agent answer call
4. Voice conversation
5. Either side end call

### Scenario 2: Agent Busy
1. Agent set status = "busy"
2. Customer gá»i â†’ Call vÃ o queue
3. Agent set status = "available"
4. System auto route call to agent

### Scenario 3: Multiple Agents
1. CÃ³ 2+ agents "available"
2. Customer gá»i â†’ Route to highest priority agent
3. Test load balancing

### Scenario 4: Call Queue
1. Táº¥t cáº£ agents "busy"
2. Multiple customers gá»i â†’ All vÃ o queue
3. Agent available â†’ System route theo thá»© tá»± queue

### Scenario 5: WebRTC Voice
1. Complete call flow
2. Both sides mute/unmute
3. Check audio quality
4. Monitor connection status

ğŸ“Š MONITORING & DEBUG
=====================

### Real-time Monitoring:
- **Softphone logs** - Theo dÃµi call events
- **Agent dashboard logs** - Theo dÃµi agent activities
- **Browser console** - WebRTC debug info
- **Server logs** - Backend events

### API Endpoints for Monitoring:
```bash
# Check agent status
curl http://localhost:8000/api/agents/status

# Check available agents
curl http://localhost:8000/api/agents/available

# Check call center status
curl http://localhost:8000/api/call-center/status

# Check WebRTC config
curl http://localhost:8000/api/webrtc/config
```

### Common Issues & Solutions:

**1. Microphone Permission Denied**
- Solution: Enable microphone trong browser settings
- Chrome: Settings â†’ Privacy â†’ Microphone â†’ Allow

**2. No Audio**
- Check browser microphone permissions
- Verify WebRTC connection state in console
- Test with different browsers

**3. Call Not Connecting**
- Check agent status (must be "available")
- Verify WebSocket connection (green status)
- Check server logs for errors

**4. WebRTC Connection Failed**
- Check internet connection
- Verify STUN servers accessibility
- Try different network/VPN

ğŸ® QUICK TEST COMMANDS
======================

### Auto Test via Softphone:
1. VÃ o http://localhost:8000/softphone
2. Click "ğŸ‘¤ Táº¡o Test Agent" 
3. Click "ğŸ”„ Test Call Flow"
4. Observe auto call flow

### Manual API Test:
```bash
# Create agent
curl -X POST http://localhost:8000/api/agents/create \
  -H "Content-Type: application/json" \
  -d '{"userId": 1, "status": "available", "priority": 1}'

# Make call
curl -X POST http://localhost:8000/api/call/demo/initiate \
  -H "Content-Type: application/json" \
  -d '{"callerNumber": "0912345678"}'

# Check call status
curl http://localhost:8000/api/call-center/status
```

ğŸ“± PRODUCTION DEPLOYMENT
========================

### Requirements for Production:
1. **HTTPS Certificate** - WebRTC requires HTTPS
2. **TURN Servers** - For NAT traversal
3. **Load Balancer** - For multiple backend instances
4. **Database Scaling** - MySQL cluster/replication
5. **Error Monitoring** - Sentry, New Relic, etc.

### Security Considerations:
1. **Authentication** - JWT tokens for API access
2. **Rate Limiting** - Prevent call flooding
3. **Input Validation** - Sanitize all inputs
4. **Audit Logging** - Log all call activities
5. **Encryption** - End-to-end encryption for sensitive data

=========================================
READY TO TEST! ğŸš€ğŸ“ğŸ™ï¸
=========================================

Há»‡ thá»‘ng call center Ä‘Ã£ sáºµn sÃ ng cho viá»‡c test!

1. Má»Ÿ http://localhost:8000/agent-dashboard (Agent)
2. Má»Ÿ http://localhost:8000/softphone (Customer)  
3. Test call flow vÃ  voice conversation
4. Monitor real-time logs vÃ  events

âœ¨ Voice call tháº­t sá»± giá»¯a Customer vÃ  Agent! âœ¨
